---
extends: skeleton/_base.html
title: Advanced tutorial
---

{% block content %}

{% restructuredtext %}

What this tutorial is about?
============================
In this tutorial we will present more advanced features of Troia.
We will cover topics like incremental version of algorithm, marking objects as gold or retreving more advanced statistics.

As in base tutorial we will use `cURL <http://curl.haxx.se/>`_ to communicate with Troia Server API.


Incremental Dawid-Skene
-----------------------
In Troia we have two versions of Dawid-Skene algorithm.
Batch version requires user to inform Troia to preform some calculations explictly.
Incremental version doesn't require this.
It does some computations when you add some data to job or modify them.
From user point of view main difference is that it doesn't require to call **calculate** go give some meaningfull results.

Let see it in action.


Sample usage
++++++++++++

When you create job you can specify **type** parameter.
Default value is *batch*.
Other choice would be *incremental*.
It will result in creating job which uses incremental version of *Get-Another-Label* algorithm.

We will go through the same example as in basic tutorial.

::

    curl -X POST -H "Content-Type: application/json" "http://project-troia.com/api/jobs" -d 'id=IncrementalDS&type=incremental&categories=
    [{
        "prior":"1",
        "name":"porn",
        "misclassification_cost":
        {
            "porn":"0",
            "notporn":"1"
        }
    },
    {
        "prior":"1",
        "name":"notporn",
        "misclassification_cost":
        {
            "porn":"1",
            "notporn":"0"
        }
    }]'

Remember that we also need to send collection of **categories**, containing their names, priorities and misclassification costs matrix.


Similarly to basic tutorial we should now upload assigned labels.


After doing this we are ready to retrieve results.
For example to get predicted labels for all objects just call
::

    curl -X GET "http://project-troia.com/api/jobs/IncrementalDS/prediction/data"

After going to redirect you should obtain:

::

    {
        "result": {
            "http://google.com": "notporn",
            "http://sex-mission.com": "porn",
            "http://sunnyfun.com": "notporn",
            "http://yahoo.com": "notporn",
            "http://youporn.com": "porn"
        },
        "status": "OK",
        "timestamp": "2013-01-15T15:53:30.378+01:00"
    }


To see label probability distribution for *http://yahoo.com*:

::

    curl -X GET "http://project-troia.com/api/jobs/IncrementalDS/data/http://yahoo.com/categoryProbability

And after redirecting you should get:

::

    {
        "result": {
            "notporn": 0.97945,
            "porn": 0.02055
        },
        "status": "OK",
        "timestamp": "2013-01-15T15:56:15.429+01:00"
    }



Computation
+++++++++++

Basic calculations are done as we manipulate data.
We can force more computations.
More computations in some cases leads to better results.
This is true mostly for some complicated and huge data.

::

    curl -X POST -d "iterations=20" "http://project-troia.com/api/jobs/IncrementalDS/compute"


Doing this on our example data changes label probability distribution for *http://yahoo.com*:

::

    curl -X GET "http://project-troia.com/api/jobs/IncrementalDS/data/http://yahoo.com/categoryProbability

results with:

::

    {
        "result": {
            "notporn": 0.98,
            "porn": 0.02
        },
        "status": "OK",
        "timestamp": "2013-01-15T16:00:24.162+01:00"
    }



{% endrestructuredtext %}

{% endblock %}

