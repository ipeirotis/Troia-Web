---
extends: skeleton/_base.html
title: Base tutorial
---

{% block content %}

{% restructuredtext %}

What this tutorial is about?
============================
This tutorial would show you, step by step, how to play with Troia Server. We would use `cURL <http://curl.haxx.se/>`_ to communicate with Troia Server API.

Create job
----------
To create new job with **id** *troia_tutorial* simply enter:
::

    curl -X POST -d "id=troia_tutorial&type=batch" "http://project-troia.com/api/jobs"

As you can see there's another parameter **type**, which have two possible values: *batch, incremental* determinig type of DawidSkene.

As a result we get JSON:
::

    {
        "timestamp":"2012-12-29T12:27:28.926Z",
        "result":"New job created with ID: troia_tutorial",
        "status":"OK"
    }

Load categories
---------------
We send cost matrix that contains all labels/categories. We should do this after job creation but only ones (later calls will be omitted).
::

    curl -X POST -H "Content-Type: application/json" "http://project-troia.com/api/jobs/troia_tutorial/categories"
    -d 'categories=
    [{
        "prior":"1",
        "name":"porn",
        "misclassification_cost":
        {
            "porn":"0",
            "notporn":"1"}
        },
    {
        "prior":"1",
        "name":"notporn",
        "misclassification_cost":
        {
            "porn":"1",
            "notporn":"0"
        }
    }]'

As a result we get JSON:
::

    {
        "timestamp":"2012-12-29T13:14:41.299Z",
        "status":"OK",
        "redirect":"1"
    }

That means we need to call:
::

    curl -X GET "http://project-troia.com/api/jobs/troia_tutorial/status/1"

to see what is the status of calling load categories method.
As a result we get another JSON:
::

    {
        "timestamp":"2012-12-29T13:22:09.849Z",
        "result":"Categories added",
        "status":"OK"
    }

This way of getting command results concerns all of the following methods.

Load assigned labels
--------------------
Send labels that worker assigned to objects.
::

    curl -X POST -H "Content-Type: application/json" "http://project-troia.com/api/jobs/troia_tutorial/assignedLabels"
    -d 'labels=
    [{
        "workerName":"worker1",
        "objectName":"http://sunnyfun.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker1",
        "objectName":"http://sex-mission.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker1",
        "objectName":"http://google.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker1",
        "objectName":"http://youporn.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker1",
        "objectName":"http://yahoo.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker2",
        "objectName":"http://sunnyfun.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker2",
        "objectName":"http://sex-mission.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker2",
        "objectName":"http://google.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker2",
        "objectName":"http://youporn.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker2",
        "objectName":"http://yahoo.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker3",
        "objectName":"http://sunnyfun.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker3",
        "objectName":"http://sex-mission.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker3",
        "objectName":"http://google.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker3",
        "objectName":"http://youporn.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker3",
        "objectName":"http://yahoo.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker4",
        "objectName":"http://sunnyfun.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker4",
        "objectName":"http://sex-mission.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker4",
        "objectName":"http://google.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker4",
        "objectName":"http://youporn.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker4",
        "objectName":"http://yahoo.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker5",
        "objectName":"http://sunnyfun.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker5",
        "objectName":"http://sex-mission.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker5",
        "objectName":"http://google.com",
        "categoryName":"porn"
    },
    {
        "workerName":"worker5",
        "objectName":"http://youporn.com",
        "categoryName":"notporn"
    },
    {
        "workerName":"worker5",
        "objectName":"http://yahoo.com",
        "categoryName":"porn"
    }]'


Load gold labels
----------------
Send samples for which we know correct label
::

    curl -X POST -H "Content-Type: application/json" "http://project-troia.com/api/jobs/troia_tutorial/goldData"
    -d 'labels=
    [{
        "correctCategory": "notporn",
        "objectName": "http://google.com"
    }]'

Start compute
-------------
We start actual calculations
::

    curl -X POST -d "iterations=20" "http://project-troia.com/api/jobs/troia_tutorial/compute"

As a result, as previously we get JSON containg redirect id:
::

    {
        "timestamp":"2012-12-29T13:39:07.769Z",
        "status":"OK",
        "redirect":"5"
    }

Get results
-----------
To collect workers results we call:
::

    curl -X GET "http://project-troia.com/api/jobs/troia_tutorial/prediction/workers"

Stats include workers error rate, quality (both optimized and exptected), number of annotations, number of gold tests and their confusion matrix.

To see what are the most likely categories for data use:

{% endrestructuredtext %}

{% endblock %}

